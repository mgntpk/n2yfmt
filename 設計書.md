# n2yfmt設計書 <!-- omit in toc -->

## 目次 <!-- omit in toc -->

- [ツールの目的](#ツールの目的)
  - [背景・動機](#背景動機)
  - [概要](#概要)
  - [設計方針](#設計方針)
- [技術仕様](#技術仕様)
  - [実行環境](#実行環境)
  - [使用技術](#使用技術)
- [入力内容](#入力内容)
- [出力内容](#出力内容)
- [入力例と出力例](#入力例と出力例)
- [処理の流れ](#処理の流れ)
- [画面構成](#画面構成)

## ツールの目的

### 背景・動機

ニコ生からYouTubeへの転載作業において、番組情報の整形と時刻計算が
毎回発生する手作業となっている。この部分を自動化することで
作業効率を向上させたい。

### 概要

ニコ生の番組情報テキストを整形し、YouTube概要欄用の形式に変換する。

### 設計方針

本ツールは個人利用を目的とする。  
開発労力および将来的な保守コストの最小化を基本方針とし、  
その制約の中で実現可能な範囲で利便性を考慮する。

1. **外部依存の排除**  
APIやWebスクレイピングは技術的複雑性や仕様変更リスクを伴うため採用しない。  
これにより、外部環境の変化に影響されない安定した動作を維持する。

1. **責務範囲の最適化**  
プログラムの責務を、利用者にとって最も手間となる「整形・計算処理」に限定する。  
一方、データの取得や選別は利用者の手動作業とする。  
この設計により、外部仕様の変更によって発生する保守作業を極力減らし、入力内容の問題箇所を利用者自身で修正できるようにする。

## 技術仕様

### 実行環境

- ブラウザ：edge（他ブラウザでの動作は未確認）

### 使用技術

- HTML5
- CSS3
- JavaScript ES6以降（ライブラリ不使用）

## 入力内容

- 入力1

```text
番組タイトル
日付 開始時間(放送時間)
番組説明文
```

- 入力2

```text
タグ1
タグ2
タグ3
…
```

## 出力内容

```text
【タイトル】番組タイトル
【放送時間】開始日時〜終了日時
【説明文】
番組説明文
【タグ】タグ1 タグ2 タグ3 …
【元配信】
```

## 入力例と出力例

取得元:<https://live.nicovideo.jp/watch/lv348996578>

- 元の生データ（ブラウザからコピーした状態）

```text
テスト配信
2025/10/21(火) 6:53開始(5分)
番組編集
ポストする


ゲスト
ゲスト
LV1

一般(その他)
一般
ルーキー
一般会員
タグ編集
ゲストの放送です
```

- 入力1の例
  
```text
テスト配信
2025/10/21(火) 6:53開始(5分)
ゲストの放送です
```

- 入力2の例
  
```text
一般(その他)
一般
ルーキー
一般会員
```

- 出力例

```text
【タイトル】テスト配信
【放送時間】2025/10/21(火) 06:53〜06:58
【説明文】
ゲストの放送です
【タグ】一般(その他) 一般 ルーキー 一般会員
【元配信】
```

※【元配信】の後ろには利用者が手動で元配信のURLを載せる。

## 処理の流れ

1. 入力1のテキストを取得。
2. 1行目からタイトルを取得。
3. 2行目から日付・時間を取得。
4. 取得した日付と時間から終了日時を計算する。
   - 開始時間 + 括弧内の放送時間で終了時間を求める。
5. 3行目以降から説明文を取得。
6. 入力2にテキストがあればタグとして取得。
7. 整形する。
   - 【タイトル】【放送時間】【説明文】【タグ】【元配信】の形式。
   - [出力内容](#出力内容)を参照。
8. 出力欄に表示。

## 画面構成

入力欄①：入力1形式のテキスト。  
入力欄②：入力2形式のタグテキスト。（任意）  
実行ボタン：入力欄①と入力欄②からテキストを取得し整形、出力欄に出力。  
出力欄：整形済みテキスト。  
コピーボタン：出力欄の整形済みテキストをクリップボードにコピー。
